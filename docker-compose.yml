version: '3.8'

services:
  trading-bot:
    build:
      context: ./websocket-service
      dockerfile: Dockerfile
    container_name: trading-bot
    restart: unless-stopped
    ports:
      - "8000:8000"
    environment:
      # API Credentials
      COINBASE_API_KEY: ${COINBASE_API_KEY}
      COINBASE_SIGNING_KEY: ${COINBASE_SIGNING_KEY}
      POLYGON_API_KEY: ${POLYGON_API_KEY}

      # Trading Configuration (Vol AND Support 120 Candles strategy)
      PROVEN_AUTO_TRADE: "yes"
      PROVEN_INITIAL_CAPITAL: "400"

      # Email Notifications (Optional)
      GMAIL_ADDRESS: ${GMAIL_ADDRESS:-}  # Your Gmail address for daily reports
      GMAIL_APP_PASSWORD: ${GMAIL_APP_PASSWORD:-}  # Gmail app password

      # Server
      PORT: 8000

    volumes:
      - ./data:/app/data
      - ./websocket-service:/app
    command: python main.py
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8000/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
